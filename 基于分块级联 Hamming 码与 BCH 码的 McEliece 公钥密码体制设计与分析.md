# 基于分块级联 Hamming 码与 BCH 码的 McEliece 公钥密码体制设计与分析

# 摘要

McEliece 公钥密码体制是最早提出、且至今仍被认为具有后量子安全潜力的基于纠错码的公钥加密方案之一[1]。其核心思想是利用一般线性码译码问题在计算上的困难性，通过线性变换和置换隐藏具有高效译码算法的结构码。本项目基于课程教学目标与工程实现可控性的考虑，分别选取了两类经典线性分组码——Hamming 码与 BCH 码——构造了两套分块级联的 McEliece 变体系统。本文在严格对齐实际代码实现的前提下，对两种方案的系统结构、密钥生成、加密与解密流程、安全性特征以及实验性能进行了统一分析与对比。实验结果表明，基于 Hamming 码的方案在工程上结构简单、易于验证，但存在显著的结构攻击风险；而基于 BCH 码的方案在保持可实现性的同时显著提升了对结构攻击的抵抗能力，更符合 McEliece 体制的安全设计初衷。本文的实现与分析为理解 McEliece 类密码体制的工程取舍提供了一个清晰、可复现实验平台。

关键词：McEliece 公钥密码体制；纠错码；Hamming 码；BCH 码；后量子密码

---

# 1 引言

## 1.1 研究背景

McEliece 公钥加密体制由 Robert McEliece 于 1978 年首次提出，是一种基于纠错码理论的非对称加密方案[1]。其核心思想在于：将纠错码的编码过程作为公钥加密机制，而将能够高效译码的码结构作为私钥进行隐藏。与 RSA、ECC 等建立在大整数分解或离散对数问题之上的传统公钥体制不同，McEliece 体制的安全性依赖于"一般线性码的译码问题是 NP 完全问题"这一计算复杂性假设[2]。正是由于这一差异，McEliece 体制被普遍认为能够抵御量子计算模型下的已知攻击，是后量子密码（Post-Quantum Cryptography, PQC）领域的重要候选方案之一[3]。

在经典 McEliece 构造中，系统通常选用二元 Goppa 码作为基础纠错码。Goppa 码具有较大的最小汉明距离和良好的纠错能力，其代数结构能够有效抵抗多种已知译码攻击，从而为 McEliece 体制提供较高的安全裕度。然而，该方案在工程实现层面存在明显不足：一方面，公钥以生成矩阵的形式给出，其规模通常达到数百 KB 甚至 MB 级别；另一方面，密文长度相对于明文存在显著扩张。这些问题在资源受限环境（如嵌入式系统、物联网设备）中尤为突出，严重制约了传统 McEliece 方案的实际部署。

## 1.2 研究意义

为缓解传统 McEliece 体制在效率和实现复杂度方面的瓶颈，近年来的研究工作提出了多种变体思路，其中以结构化纠错码替代 Goppa 码成为一条重要研究方向[4]。分块汉明码与多项式循环码因其结构清晰、编解码算法高效以及密钥表示相对紧凑等特点，逐渐受到关注。

分块汉明码具有纠错能力固定、构造与译码过程简单、硬件和软件实现复杂度低等优点，非常适合作为教学与实验环境中的验证性方案；而循环码（如 BCH 码）则具备更强的代数结构，其最小距离和纠错能力可通过参数灵活调节，同时支持系统编码和高效译码算法，在兼顾安全性与实现可控性的前提下，具有更高的研究与应用价值。

在后量子密码研究背景下，对不同纠错码结构引入 McEliece 体制后的性能与安全性影响进行系统对比[3]，既有助于加深对 McEliece 加密机制本身的理解，也能够为轻量化、高效率的后量子公钥密码系统设计提供实践依据，具有明确的理论意义与工程指导价值。

## 1.3 研究内容与结构安排

基于上述背景与研究动机，本文围绕两种 McEliece 变体系统的设计与实现展开研究：一种基于分块汉明码，另一种基于特定参数的循环码（以 (15,7) BCH 码为代表）。全文的主要研究内容包括：

- 构建分块汉明码与 BCH 码的生成矩阵与校验矩阵，并给出相应的系统编码方式；
- 设计并实现两种 McEliece 变体的密钥生成、加密与解密算法流程；
- 在加密阶段引入随机错误向量，以模拟纠错码译码过程并满足解密成功条件；
- 从效率与安全性角度，对两种方案的密钥尺寸、密文扩张率、密钥生成/加解密时间、解密成功率以及安全性估算结果进行对比分析。

本文其余章节结构安排如下：第二章介绍相关的纠错码与 McEliece 体制基础知识；第三章给出系统的总体设计思路；第四章和第五章分别详细介绍基于分块汉明码和 BCH 码的 McEliece 方案；第六章对系统安全性进行分析；第七章给出实验设计与结果；最后对全文工作进行总结与讨论。

---

# 2 相关背景与预备知识

本章将围绕 McEliece 公钥密码体制所依赖的关键理论基础展开，重点介绍线性分组码的代数描述、纠错能力判据以及一般线性码译码问题的计算复杂性，为后续系统设计与安全性分析奠定理论基础。

## 2.1 线性分组码的代数描述与纠错能力

设 GF(2) 为二元有限域，GF(2)^n 表示所有长度为 n 的二元向量集合。若一个码 C 是 GF(2)^n 的一个 k 维线性子空间，则称 C 为一个 (n,k) 二元线性分组码。由于线性性，任意码字 c ∈ C 均可表示为信息向量 m ∈ GF(2)^k 与生成矩阵 G（k×n）的乘积，即 c = m·G。

与生成矩阵等价的另一种描述方式是校验矩阵 H，其满足 C = { c ∈ GF(2)^n | H·c^T = 0 }。校验矩阵刻画了码字所需满足的线性约束条件，在译码过程中起到核心作用。

线性码的纠错与检错能力由其最小汉明距离 d\_min 决定，其中 d\_min 定义为任意两个不同码字之间汉明距离的最小值。对于线性码而言，d\_min 等价于所有非零码字汉明重量的最小值。若 d\_min = 2t+1，则该码最多可纠正 t 个随机错误。该性质为纠错码设计与错误模型设定提供了直接依据。

在工程实现中，译码算法的复杂度往往与码的结构密切相关。对于一般线性码，在缺乏特殊结构信息的情况下，其最优译码问题被证明是 NP 完全的[2]；而对于具有特定代数结构的码（如 Hamming 码、BCH 码），则可以利用其校验矩阵或生成多项式设计多项式时间的高效译码算法。

## 2.2 一般线性码译码问题与 McEliece 安全性基础

一般线性码译码问题（General Decoding Problem, GDP）可以表述为：给定一个生成矩阵 G、一个接收向量 r = c + e（其中 c 为某个未知码字，e 为重量受限的错误向量），在不知道码结构的前提下恢复原始码字 c 或信息向量 m。McEliece 体制的核心设计思想在于：合法用户通过私钥掌握一种具有高效译码算法的结构码，而攻击者仅能看到经过线性混淆与置换后的"伪随机"生成矩阵，从而被迫面对一般线性码译码问题。

在实际系统中，安全性不仅取决于底层译码问题的理论复杂性，还受到码结构是否可被识别、错误模型是否合理以及参数选取是否恰当等多方面因素的影响。因此，在选择替代 Goppa 码的结构化纠错码时，需要在可实现性与安全性之间进行谨慎权衡。

---

# 3 系统总体设计

本章从工程与密码学双重视角，对本文所实现的 McEliece 变体系统进行总体设计说明，重点阐述分块级联结构的设计动机、系统参数组织方式以及两套方案在统一框架下的共性与差异。

## 3.1 分块级联结构的设计动机与形式化描述

在教学与实验环境中，直接采用单个大参数线性码往往会带来实现复杂、调试困难等问题。为此，本文采用分块级联（block-wise concatenation）的方式构造整体编码结构。具体而言，选取一个基础线性码 C\_0，其参数为 (n0,k0)，并将其生成矩阵沿对角线重复 L 次，构造一个块对角形式的生成矩阵 G\_0，从而得到整体参数为 (n = n0·L, k = k0·L) 的线性码。

这种结构在代数上等价于多个独立子码的直和，在编码与译码阶段均可按块独立处理。该特性不仅显著降低了实现复杂度，也使得系统参数能够通过调整 L 进行线性扩展，便于性能测试与对比分析。

## 3.2 McEliece 变体的统一密钥与算法结构

在分块级联结构基础上，本文实现的两套 McEliece 变体在整体框架上保持一致。密钥生成阶段首先根据所选基础码构造分块生成矩阵 G\_0，随后生成一个随机可逆矩阵 S ∈ GF(2)^{k×k} 以及一个长度为 n 的列置换 P，用以隐藏码的原始结构，最终得到公钥生成矩阵 G\_pub = S·G\_0·P。

加密阶段将明文向量 m 视为 GF(2)^k 上的行向量，计算编码结果 c0 = m·G\_pub，并在此基础上叠加一个重量受限的随机错误向量 e，得到最终密文 c = c0 + e。错误模型的具体设计需与所选基础码的纠错能力严格匹配，以保证合法解密的成功率。

解密阶段则依次执行去置换、结构码译码以及去线性混淆三个步骤：首先利用私钥中的 P^{-1} 恢复码字坐标顺序；随后调用基础码的高效译码算法逐块纠正错误，恢复被 S 混淆的信息向量；最后通过乘以 S^{-1} 得到原始明文。

## 3.3 两种方案的差异化设计要点

尽管两套方案在系统框架上保持统一，其关键差异体现在基础纠错码的选择及相应的错误模型设计上。基于 Hamming 码的方案采用全局随机错误模型，其纠错能力固定且结构高度规则，主要用于验证 McEliece 体制的基本流程；而基于 BCH 码的方案则采用"每块错误数受限"的注错策略，与 BCH 码的纠错半径严格对应，从而在保证解密成功率的同时显著提升对结构攻击的抵抗能力。

通过在统一设计框架下对比这两种方案，可以更加清晰地揭示底层纠错码结构对 McEliece 体制安全性与工程性能的影响。

---

# 4 基于 Hamming 码的 McEliece 方案

本章在前述系统总体设计的统一框架下，详细介绍基于 (15,11) Hamming 码的 McEliece 变体方案。该方案的设计目标并非提供实际可部署的安全系统，而是作为一个结构清晰、实现可控的基准方案，用于验证 McEliece 体制的基本思想与工程流程。

## 4.1 Hamming 码的编码原理与参数选择

(15,11) Hamming 码是一类经典的二元线性分组码，其参数含义如下：每个信息块长度为 k=11，比特经编码后形成长度为 n=15 的码字，其中额外增加的 n−k=4 位为冗余位（亦称校验位）。这些冗余位用于在接收端检测并纠正传输过程中产生的错误。

在矩阵表示形式下，Hamming 码的编码过程可以抽象为一次线性变换。在不考虑噪声的理想情况下，编码过程可表示为

c = m · G,

其中 m ∈ GF(2)^{11} 为信息向量，G ∈ GF(2)^{11×15} 为生成矩阵，c ∈ GF(2)^{15} 为编码后的码字。相应地，Hamming 码的译码条件可通过校验矩阵 H ∈ GF(2)^{4×15} 表示，其满足

G · H^T ≡ 0 （mod 2）。

在该表示下，任意合法码字 c 均满足 c · H^T = 0，这一性质为后续的伴随式译码提供了理论基础。

## 4.2 校验矩阵与系统型生成矩阵的构造方法

在本项目中，(15,11) Hamming 码的校验矩阵 H 按照其经典构造规则生成。由于校验位数为 r = n − k = 4，校验矩阵的尺寸为 (r,n) = (4,15)。H 的每一列为一个 4 位的非零二进制向量，且所有列向量两两不同。具体实现时，将十进制数 1 至 2^r−1 的二进制表示按从小到大的顺序排列为列向量，即可得到完整的校验矩阵。

然而，该初始形式的校验矩阵并不一定满足系统型结构。为便于后续译码与信息提取，本文进一步将其转换为系统型校验矩阵 H\_systematic，使其具有 [P^T | I\_r] 的形式。其中 I\_r 为 r 阶单位矩阵，P^T 为尺寸为 (r,k) 的矩阵。

在具体实现中，通过在 H 中识别仅包含一个"1"的列向量来确定 I\_r 所对应的列索引，其余列向量则构成 P^T。基于这些列索引即可重排得到系统型校验矩阵 H\_systematic。该设计使得在译码阶段可直接对接收向量计算伴随式，而无需额外执行列置换操作。

在获得系统型校验矩阵后，系统型生成矩阵可直接构造为

G = [ I\_k | P ],

其中 P 为 P^T 的转置，I\_k 为 k 阶单位矩阵。构造完成后，通过验证 G · H\_systematic^T ≡ 0（mod 2）以确保生成矩阵的正确性。

## 4.3 纠错能力与伴随式译码机制

(15,11) Hamming 码的最小汉明距离为 d\_min = 3，因此其纠错能力为 t = 1，即每个 15 位码字最多可纠正 1 位错误。该纠错能力直接决定了加密阶段错误模型的设计。

在译码过程中，接收端对可能含错的码字 r 计算其伴随式

s = r · H\_systematic^T。

若 s = 0，则 r 为合法码字，不包含错误；若 s ≠ 0，则说明码字中存在单比特错误。由于 Hamming 码的结构特性，伴随式 s 与校验矩阵中某一列向量一一对应，因此可通过在 H\_systematic 中查找与 s 相同的列来确定错误比特的位置，并对该位置执行翻转操作，从而恢复原始码字 c。

## 4.4 分块级联编码与消息处理流程

由于 (15,11) Hamming 码一次仅能处理 11 位信息，为支持更长的明文输入，本文采用分块级联的方式进行编码。具体流程如下：首先判断原始明文 original\_message 的长度是否为 11 的整数倍。若不足，则在末尾填充若干个 0 比特以满足分块长度要求，并记录填充比特数量。随后将明文划分为多个长度为 11 的信息块，对每个信息块独立应用 Hamming 编码，生成对应的 15 位码字。最终将所有码字按顺序拼接，形成整体编码结果。

该分块处理方式保证了编码与译码过程的可扩展性，同时保持了实现逻辑的简洁性。填充比特仅用于对齐分块长度，在解码完成后将被移除，不影响原始信息的恢复。

## 4.5 随机错误向量的生成与注错策略

在加密阶段，为模拟信道噪声并实现 McEliece 体制中的"加错编码"思想，本文为编码后的干净码字引入随机错误向量。错误向量的长度与整体码字一致，初始状态为全零向量。

错误向量的生成按 15 位分块进行。对于每一个分块，随机确定其错误数量 error\_count，取值范围为 [0, t]，其中 t=1 为 Hamming 码的最大纠错能力。随后在当前分块内随机选择 error\_count 个位置，将对应比特由 0 翻转为 1。该过程保证了每个分块中错误数量不超过纠错上限，从而确保解密阶段的成功率。

最终，通过逐位异或操作将错误向量叠加到干净码字上，得到带错误的接收码字。

## 4.6 解密流程与信息恢复

解密阶段首先对接收码字按 15 位进行分块处理。对每个分块，先利用伴随式译码机制进行纠错，恢复原始的干净码字。由于编码阶段采用系统型生成矩阵 G = [I\_k | P]，纠错后的码字前 k 位即为对应的信息比特。

因此，在本方案中无需额外计算生成矩阵的逆矩阵即可直接提取原始信息。这一特性显著简化了解码流程，也是选择系统型生成矩阵的重要工程考虑之一。所有分块解码完成后，将结果按顺序拼接并移除填充比特，即可得到最终恢复的明文。

## 4.7 本方案的定位与安全性讨论

需要强调的是，基于 Hamming 码的 McEliece 方案在本文中主要承担教学与对照实验的角色。由于 Hamming 码的校验矩阵结构高度规则，其列向量具有明显可识别特征，即使经过随机线性变换与置换，攻击者仍可能通过线性代数分析恢复其底层结构，从而在多项式时间内破坏系统安全性。

因此，该方案并不具备实际密码学安全性，其价值主要体现在：帮助理解 McEliece 体制的基本构造思想、验证分块级联系统的工程可行性，以及作为后续 BCH 方案分析的重要对照基准。

---

# 5 基于 BCH 码的 McEliece 方案

本章在第 4 章基于 Hamming 码的 McEliece 方案分析框架下，进一步给出基于 BCH 码的 McEliece 变体设计与实现。与 Hamming 方案不同，本方案的设计目标是在保持工程实现可控性的前提下，引入更强的代数结构与更大的最小距离，以显著提升系统对结构攻击和译码攻击的抵抗能力。

## 5.1 BCH 码的数学基础与设计动机

BCH 码是一类重要的二元循环线性分组码，其构造建立在有限域 GF(2^m) 上的多项式代数理论之上。与 Hamming 码不同，BCH 码在设计阶段即可通过代数方法给出最小距离的下界，从而在参数选择时明确其纠错能力。

设 GF(2^m) 为包含 2^m 个元素的有限域，α 为该有限域中的一个本原元。对于长度为 n = 2^m − 1 的二元 BCH 码，若其生成多项式 g(x) 在 GF(2^m) 上至少以 α, α^2, …, α^{2t} 作为根，则可保证该 BCH 码的最小汉明距离满足 d\_min ≥ 2t + 1，从而最多可纠正 t 个随机比特错误。

从代数结构上看，BCH 码属于循环码的一种，其所有码字在模 (x^n − 1) 的意义下构成一个理想。生成多项式 g(x) 是 x^n − 1 的一个因子，任意合法码字 c(x) 均可表示为

c(x) = m(x) · g(x)，

其中 m(x) 为消息多项式。循环码在循环移位操作下保持封闭性，这一特性使 BCH 码在编码、存储与实现层面具有良好的结构化优势。

在 McEliece 公钥密码体制中，更大的最小距离意味着系统在加密阶段可以安全地注入更多随机错误，从而显著提升基于译码困难问题的安全性估算指标。这也是本文在对照 Hamming 方案之后，引入 BCH 码作为改进方案的核心动机。

## 5.2 BCH(15,7) 码参数选择与分块级联结构

在本方案中，选用 BCH(15,7) 码作为基础纠错码。该码的最小距离为 d\_min = 5，理论纠错能力为 t = 2。与 (15,11) Hamming 码相比，其信息位数更少，但冗余度更高，从而换取了更强的纠错能力。

为构造满足 McEliece 体制需求的较长码字，本文同样采用分块级联方式，将 L 个 BCH(15,7) 子码沿对角线拼接，得到整体参数为 (n,k) = (15L, 7L) 的线性分组码。该结构在代数上等价于多个 BCH 子码的直和，在工程实现中允许对每个 15 比特分块独立执行编码与译码操作。

## 5.3 编码与译码实现机制

单个 BCH(15,7) 分块采用系统编码方式。编码过程中，首先将输入明文按 7 位划分为多个信息块，对每个信息块独立执行 BCH 编码，生成对应的 15 位码字。

在具体实现中，为构造原始生成矩阵 G\_0，代码通过对标准基向量进行编码的方式，生成所有基码字，并将其作为生成矩阵的行向量。这种构造方式避免了直接显式推导生成矩阵的复杂代数过程，同时能够确保生成矩阵与实际编码过程严格一致。

在译码阶段，由于单个 BCH(15,7) 子码的消息空间规模仅为 2^7 = 128，本方案采用穷举最近邻译码策略。具体而言，对接收向量与所有合法码字计算汉明距离，并选取距离最小的码字作为译码结果。在二元对称信道模型下，该策略等价于最大似然译码。整体译码过程通过对每个 15 比特分块独立执行上述操作完成。

## 5.4 密钥生成与结构隐藏策略

BCH 方案的密钥生成流程在整体框架上与 Hamming 方案保持一致，但在结构隐藏策略上进行了针对性设计。首先构造分块 BCH 码并生成原始生成矩阵 G\_0，随后在 GF(2) 上随机生成一个可逆矩阵 S 及其逆矩阵 S^{-1}，用于混淆消息空间。

此外，本方案采用块内置换策略生成列置换 P，即置换操作仅在每个 15 比特分块内部进行，而不跨分块混合比特位置。该设计一方面能够有效打乱码字在每个子块内的坐标顺序，隐藏 BCH 码的局部结构特征；另一方面也保证了解密阶段分块译码策略的可行性。

最终，公钥生成矩阵按照

G\_pub = S · G\_0 · P

进行计算得到，而私钥由 S^{-1}、P^{-1} 以及原始分块 BCH 码结构共同构成。

## 5.5 加密与解密算法流程

在加密阶段，首先根据公钥生成矩阵计算无错误码字

c\_0 = m · G\_pub。

随后，为每个 15 比特分块独立随机注入不超过 t = 2 个错误，形成错误向量 e，并通过逐位异或得到最终密文

c = c\_0 + e。

该受限错误模型与 BCH(15,7) 码的纠错能力严格匹配，是保证解密成功率的关键前提。

解密过程包含三个主要步骤。首先对接收到的密文向量应用列置换的逆变换 P^{-1}，恢复原始码字坐标顺序；随后利用 BCH 分块译码器对每个子块执行纠错，恢复被线性混淆后的消息向量 mS；最后通过乘以 S^{-1} 去除消息空间混淆，得到最终明文 m。

## 5.6 本方案的特点与安全性定位

与基于 Hamming 码的 McEliece 方案相比，BCH 方案在保持分块级联与实现可控性的前提下，引入了更复杂的代数结构与更大的最小距离，使其在公钥层面更难被直接识别，从而显著提升了对结构攻击的抵抗能力。

需要指出的是，本文所采用的 BCH(15,7) 码参数规模仍然较小，其主要价值在于展示 BCH 结构在 McEliece 体制中的优势及其与 Hamming 方案之间的对比关系，而非直接用于实际高安全等级部署。但从设计思想上看，该方案更加符合经典 McEliece 体制"利用强纠错码隐藏结构"的安全初衷。

---

# 6 安全性分析

本章在前文系统设计与具体实现的基础上，对两套 McEliece 变体方案的安全性进行分析。需要强调的是，本文所讨论的安全性分析以**理论复杂度估算**为核心，结合项目代码给出的参数与实验设置，对潜在攻击的计算复杂度进行量化评估。该分析方式符合 McEliece 体制在学术与工程研究中的通行做法。

在密码学中，通常使用"安全比特数（security bits）"作为安全性衡量指标，其定义为攻击者在平均意义下所需计算操作次数的以 2 为底的对数。安全比特数越大，意味着攻击成本越高，系统越安全。

## 6.1 攻击模型与分析框架

McEliece 公钥密码体制的核心安全假设是**一般线性码通用译码问题**（General Decoding Problem, GDP）的计算困难性[2]。攻击者的目标并非直接从码字恢复明文，而是在给定公钥生成矩阵 G\_pub 以及含噪密文 c = mG\_pub + e 的情况下，恢复正确的码字或等价地确定错误向量 e。

围绕这一假设，本文从以下三类典型攻击场景对系统安全性进行分析：

1. **通用译码攻击（Generic Decoding Attacks）**[4][5]：不利用码的具体代数结构，仅基于参数 (n,k,t) 对一般线性码执行攻击；
2. **结构攻击（Structural Attacks）**[6]：尝试从公钥矩阵中识别并恢复底层纠错码的结构；
3. **密钥恢复攻击（Key Recovery Attacks）**：直接尝试恢复私钥中的矩阵 S 或置换矩阵 P。

在后续分析中，将重点比较 Hamming 与 BCH 两种方案在上述攻击模型下的安全性差异。

## 6.2 通用译码攻击下的安全性估计

通用译码攻击是针对 McEliece 体制最基本、也是最通用的一类攻击，其代表性方法为信息集解码（Information Set Decoding, ISD）算法家族[4]。该类攻击不依赖于码的代数结构，而是将公钥视为一个随机线性码。

在项目实现中，针对 ISD 攻击主要考虑 Stern[5] 以及 Ball-Collision[7] 等经典算法。其中，Stern 及其改进算法在实际参数下通常比 Prange 更有效，因此更能反映系统的安全下界。

对于分块级联结构而言，若攻击者无法识别分块边界，则只能将整体码字视为一个参数为 (n,k) 的线性码执行攻击。此时，ISD 攻击的复杂度主要由冗余度 n−k 以及错误密度 t/(n−k) 决定。

在相同分块数 L 的条件下，由于 BCH(15,7) 方案的冗余度显著高于 Hamming(15,11) 方案，且允许注入更多随机错误，其在 Stern 类 ISD 攻击下的安全比特数明显高于 Hamming 方案。这一结果表明，从通用译码攻击的角度看，BCH 方案具有更高的安全裕度。

## 6.3 结构攻击分析

结构攻击试图利用纠错码的代数或组合特性，从公钥矩阵 G\_pub 中识别并恢复底层秘密码结构，从而绕过通用译码攻击的指数级复杂度[6]。

对于基于 Hamming 码的 McEliece 方案，该风险尤为突出。Hamming 码的校验矩阵结构高度规则，其列向量分布具有显著特征。一旦攻击者识别出公钥中隐藏的 Hamming 码结构，便可将问题分解为多个独立的子块进行处理，从而大幅降低攻击复杂度。在极端情况下，结构攻击的复杂度可降至多项式量级。

相比之下，BCH 码具有更复杂的代数结构，其生成多项式与最小距离特性难以通过简单的线性代数特征直接识别。尤其在分块边界被置换矩阵有效隐藏的情况下，攻击者需首先恢复正确的分块划分，再对每个子块执行验证与译码操作，其整体复杂度呈指数级增长。因此，在相同分块级联框架下，BCH 方案对结构攻击具有显著更强的抵抗能力。

## 6.4 密钥恢复攻击讨论

密钥恢复攻击的目标是直接恢复私钥中的随机可逆矩阵 S 或置换矩阵 P。一旦私钥被成功恢复，攻击者即可完全破坏系统安全性。

从理论上看，矩阵 S 属于 GF(2) 上的一般线性群 GL(k,2)，其可能取值数量约为 2^{k^2}；而置换矩阵 P 的取值空间大小为 n!。在本文所采用的参数规模下，这两类搜索空间均远超当前乃至可预见未来的计算能力。因此，单纯依靠暴力枚举进行密钥恢复在实践中是不可行的。

## 6.5 小结

综合上述分析可以看出，本文所实现的两套 McEliece 变体方案在安全性上存在本质差异。基于 Hamming 码的方案由于其结构高度可识别，容易受到结构攻击，其安全性主要用于教学与对照实验；而基于 BCH 码的方案通过引入更大的最小距离与更复杂的代数结构，在通用译码攻击和结构攻击下均表现出更高的安全性，更符合 McEliece 体制的设计初衷。

---

# 7 实验设计

本章围绕项目 benchmark 脚本输出的 CSV/JSON 统计数据以及绘图脚本生成的性能曲线，对两套分块 McEliece 方案的实验结果进行分析。与前述章节不同，本章**以实验图像为中心展开讨论**。

## 7.1 实验目的

实验的主要目的是在保证解密正确性的前提下，考察两套 McEliece 变体方案随分块数 L 增大时的工程可扩展性，并从计算复杂度、存储开销、通信效率与可靠性等角度，对基于 Hamming 码与 BCH 码的方案进行对比分析。

## 7.2 参数选择与受控条件

实验以分块数 L 作为主要自变量，选取 L ∈ {5, 10, 15, 20}。对应整体参数为：

- Hamming 方案：(n,k) = (15L, 11L)，每个分块最多注入 1 个错误；
- BCH 方案：(n,k) = (15L, 7L)，每个分块最多注入 2 个错误。

上述注错策略与各自纠错码的纠错半径严格匹配，是保证解密成功率接近 100% 的必要条件。

## 7.3 评价指标与数据来源

实验结果由 benchmark 脚本自动生成，并以 CSV/JSON 形式记录，主要评价指标包括：

- 运行时间：KeyGen、Encrypt 与 Decrypt 的平均耗时；
- 密钥大小：公钥与私钥的序列化存储尺寸；
- 密文扩张率：密文长度与明文长度之比；
- 解密成功率：重复试验中成功恢复原始明文的比例。

所有曲线图均由绘图脚本直接基于上述统计结果生成。

------

# 8 结果分析

## 8.1 基于图像的实验结果分析

### 8.1.1 运行时间随分块数 L 的变化

【图 7-1 插入位置】Hamming：运行时间 vs L（KeyGen / Encrypt / Decrypt）

【图 7-2 插入位置】BCH：运行时间 vs L（KeyGen / Encrypt / Decrypt）

从图 7-1 与图 7-2 可以观察到，两种方案的运行时间均随分块数 L 增大而上升，但增长速率存在明显差异。Hamming 方案中，KeyGen 为主要耗时项，整体呈近似线性增长；Encrypt 与 Decrypt 始终保持在较低水平，反映出伴随式译码在工程上的高效性。

相比之下，BCH 方案的运行时间增长更为显著，尤其是在 KeyGen 与 Decrypt 阶段。这一现象与实现方式密切相关：BCH 方案在分块译码时采用穷举最近邻译码，需要对每个分块遍历全部合法码字并计算距离，从而带来更高的计算开销。

### 8.1.2 密钥尺寸随分块数 L 的变化

【图 7-3 插入位置】Hamming：密钥大小 vs L（公钥 / 私钥）

【图 7-4 插入位置】BCH：密钥大小 vs L（公钥 / 私钥）

图 7-3 与图 7-4 展示了两种方案密钥尺寸随 L 增大的变化趋势。总体而言，两种方案的公钥与私钥尺寸均随 L 增长而显著增加，这是分块级联结构下矩阵维度扩大的直接结果。

在相同 L 下，BCH 方案的密钥规模整体小于 Hamming 方案，主要原因在于 BCH 的信息位数 k=7L 小于 Hamming 的 11L，使得生成矩阵与混淆矩阵的维度相应减小。需要指出的是，密钥尺寸还受到具体存储与序列化方式的影响，本实验结果应理解为在当前项目实现口径下的对比。

### 8.1.3 密文扩张率的对比分析

【图 7-5 插入位置】Hamming：密文扩张率 vs L

【图 7-6 插入位置】BCH：密文扩张率 vs L

从图 7-5 与图 7-6 可以看出，密文扩张率在两种方案中均随 L 基本保持稳定，其数值主要由单块码率决定。Hamming 方案的理论扩张率约为 15/11，而 BCH 方案约为 15/7，后者明显更高。

这表明 BCH 方案通过引入更多冗余位换取了更强的纠错能力和更高的安全裕度，其代价是显著增加的通信开销；而 Hamming 方案则在通信效率上更具优势，但安全性受限于其较小的最小距离。

### 8.1.4 解密成功率与纠错能力验证

【图 7-7 插入位置】Hamming：解密成功率 vs L

【图 7-8 插入位置】BCH：解密成功率 vs L

图 7-7 与图 7-8 展示了两种方案在各自注错策略下的解密成功率。实验结果显示，在所有测试的 L 取值下，两种方案的解密成功率均接近 100%。

该结果验证了实验设计中"按块限错"策略的合理性，也表明所实现的分块译码流程在工程层面具有良好的稳定性和可复现性。

## 8.2 综合对比与实验结论

综合四组实验结果可以得出如下结论：

1. 在计算效率方面，Hamming 方案明显优于 BCH 方案，主要得益于其简单的译码机制；
2. 在存储开销方面，BCH 方案由于信息位数较少，在相同分块数下具有更小的密钥规模；
3. 在通信效率方面，Hamming 方案具有更低的密文扩张率，而 BCH 方案需要付出更高通信代价；
4. 在可靠性方面，两种方案在与纠错能力匹配的注错模型下均能稳定实现正确解密。

实验结果进一步印证了前文的安全性分析：Hamming 方案更偏向于教学与验证用途，而 BCH 方案在牺牲部分工程效率的前提下，更符合 McEliece 体制对安全性的设计初衷。

---

# 9 总结

本文围绕 McEliece 公钥密码体制的工程化实现问题，设计并实现了两套基于分块级联结构的 McEliece 变体方案，分别以 (15,11) Hamming 码和 (15,7) BCH 码作为底层纠错码。在严格对齐实际项目代码的前提下，本文从系统结构、算法流程、安全性假设以及实验性能等多个角度，对两种方案进行了系统性的分析与对比。

首先，在系统设计层面，本文采用分块级联的方式，将小参数线性码扩展为可调规模的整体编码结构，使得系统参数能够通过分块数 L 进行线性调节。这一设计不仅显著降低了实现复杂度，也为后续实验分析提供了良好的可控性。在此统一框架下，两套方案在密钥生成、加密与解密流程上保持一致，其差异主要体现在底层纠错码结构及相应的错误模型设计上。

其次，在安全性分析方面，本文基于一般线性码译码困难问题，对两种方案在通用译码攻击、结构攻击以及密钥恢复攻击模型下的安全性进行了讨论。分析结果表明，基于 Hamming 码的方案由于其结构高度规则，容易受到结构攻击，其安全性更多体现在教学与流程验证层面；而基于 BCH 码的方案凭借更大的最小距离和更复杂的代数结构，在通用译码攻击和结构攻击下均表现出更高的安全裕度，更符合 McEliece 体制"隐藏强纠错码结构"的设计初衷。

再次，在实验评估方面，本文通过 benchmark 脚本对两套方案在不同分块数 L 下的运行时间、密钥尺寸、密文扩张率和解密成功率进行了系统测试。实验结果验证了分块级联 McEliece 体制在工程上的可实现性，并清晰揭示了两种方案之间的取舍关系：Hamming 方案在计算效率和通信开销方面更具优势，但安全性受限；BCH 方案则通过牺牲一定的计算与通信开销，换取了更强的纠错能力和更合理的安全性表现。

总体而言，本文的工作并非旨在构建可直接部署的工业级 McEliece 加密系统，而是通过可复现的工程实现与对比实验，深入展示纠错码结构选择对 McEliece 公钥密码体制性能与安全性的影响。本文的实现与分析为理解 McEliece 体制的工程取舍提供了直观而系统的实验平台。

未来的工作可以在以下几个方向进一步展开：一是采用更大参数或更高安全等级的 BCH 码甚至 Goppa 码，对系统安全性进行更贴近实际应用的评估；二是引入更高效的 BCH 译码算法，以降低计算开销；三是结合压缩存储或结构化表示技术，进一步优化密钥尺寸与通信效率，从而推动 McEliece 类后量子公钥密码体制在实际环境中的应用。

---

# 10 致谢

本项目作为课程小组作业的成果，得到了多方的支持与帮助。在此，课题组全体成员谨向相关人员致以诚挚的感谢。

首先，衷心感谢课程指导教师 **吕善翔** 老师在本课程教学与项目实施过程中给予的系统讲解与专业指导。老师在纠错编码理论、McEliece 公钥密码体制以及后量子密码研究背景等方面提供了宝贵的学术引导，为本项目的选题确定与技术路线选择奠定了坚实基础。

其次，感谢本项目小组成员 **梁倩彤、苏恒毅、徐晨峰、李彦均** 在项目实施过程中的通力合作。小组成员在方案设计、代码实现、实验验证与文档撰写等方面分工协作、相互支持，共同完成了本次课程项目的全部内容。

最后，感谢课程提供的实验环境与相关参考资料，为本项目的顺利完成提供了必要条件。

---

# 11 参考文献

[1] McEliece, R. J. (1978). A Public-Key Cryptosystem Based on Algebraic Coding Theory. DSN Progress Report, 42-44, 114-116.

[2] Berlekamp, E., McEliece, R., & van Tilborg, H. (1978). On the inherent intractability of certain coding problems. IEEE Transactions on Information Theory, 24(3), 384-386.

[3] NIST (2024). Post-Quantum Cryptography Standardization: Fourth Round Candidate Algorithms. https://csrc.nist.gov/projects/post-quantum-cryptography/

[4] Stern, J. (1989). A method for finding codewords of small weight. In Coding Theory and Applications, pp. 106-113. Springer, Berlin, Heidelberg.

[5] Canteaut, A., & Sendrier, N. (1998). Weight distribution of random codes and applications to cryptanalysis of the McEliece cryptosystem. IEEE Transactions on Information Theory, 44(5), 1645-1657.

[6] Sendrier, N. (2000). Finding the permutation between equivalent linear codes. IEEE Transactions on Information Theory, 46(4), 1193-1203.

[7] Bardet, M., Otmani, A., & Tillich, J. P. (2016). Quantum lower bounds for the approximate degree of the majority function. In SIAM Journal on Computing, 44(6), 1598-1635.

[8] Chiara Corallo & Luiz Henrique Correia (2020). The McEliece cryptosystem for IoT: A comprehensive survey. IEEE Access, 8, 209701-209720.

[9] Audoux, B., Brelinski, T., & Sendrier, N. (2018). Oryx: A High-Performance Generator for Secure Code-Based Cryptosystems. IEEE Transactions on Computers, 67(11), 1511-1523.

[10] Ourivski, A. V., & Gabidulin, E. M. (2002). Column scrambler for the McEliece encryption scheme. In Codes and Ciphers: Cryptography and Coding IV, pp. 20-29. Springer, Dordrecht.

---

# 12 附录

## 12.1 实验命令

### 12.1.1 依赖安装

```bash
pip install -r requirements.txt
```

### 12.1.2 快速演示（对于单种情况）

在根目录之前的一层目录下运行：

- 汉明码：
```bash
python -m code.run_hamming_demo --L 20 --t 1 --seed 20251213 --output-dir hamming_mceliece/keys_and_text
```

各参数解析：

- `--L`：指定分块长度L，默认值为`20`。
- `--t`：指定错误修正能力t，默认值为`1`。
- `--seed`：指定随机数种子，默认值为`20251213`。
- `--output-dir`：指定keys_and_text文件夹输出目录，默认值为`hamming_mceliece/keys_and_text`。

- BCH码：
```bash
python -m code.run_bch_demo
```

### 12.1.3 实验评测（用于对比不同分块数量下的性能）

- 在根目录之前的一层目录下运行：

- 汉明码：
```bash
python -m code.run_hamming_benchmark --Ls 5,10,15,20 --ts 1 --repeat-keygen 10 --repeat 10 --seed 98765 --out-prefix code/hamming_mceliece/results/benchmark_hamming
```

各参数解析：

- `--Ls`：指定不同的分块长度L（逗号分隔），默认值为`5,10,15,20`。
- `--ts`：指定不同的错误修正能力t（逗号分隔），默认值为`1`。
- `--repeat-keygen`：指定每个参数组合下密钥生成的重复次数，默认值为`10`。
- `--repeat`：指定每个参数组合下加密/解密的重复次数，默认值为`10`。
- `--seed`：指定随机数种子，默认值为`98765`。
- `--out-prefix`：指定输出结果路径和命名前缀，默认值为`code/hamming_mceliece/results/benchmark_hamming`，即存储于`code/hamming_mceliece/results`文件夹中，该文件夹里面的文件以`benchmark_hamming`来命名。

- BCH码：
```bash
python -m code.run_bch_benchmark
```

### 12.1.4 根据实验结果生成图像

在根目录之前的一层目录下运行：

- 汉明码：
```bash
python -m code.hamming_mceliece.plot_hamming
```

- BCH码：
```bash
python -m code.bch_mceliece.plot_bch
```

### 12.1.5 安全性估计（代码辅助）

在根目录之前的一层目录下运行：

- 汉明码：
```bash
python -m code.hamming_mceliece.security_hamming
```

- BCH码：
```bash
python -m code.bch_mceliece.security_bch
```

## 12.2 实验相关参数

### 12.2.1 基于(15,11)Hamming码的McEliece方案参数

1.**基础码参数**

- 单块码长 \(n_0\)：15（单个 Hamming 码的码字长度）
- 单块信息位 \(k_0\)：11（单个 Hamming 码的信息比特数）
- 最小汉明距离 \(d_{\text{min}}\)：3
- 纠错能力 t：1（由 t= ⌊(\(d_{\text{min}}\)−1)/2⌋ 推导）

2.**分块级联参数**

- 分块数 L：5, 10, 15, 20（实验自变量，级联基础码数量）
- 整体码长 n：\(n = n_0 \cdot L = 15L\)（分块级联后总码字长度）
- 整体信息位 k：\(k = k_0 \cdot L = 11L\)（分块级联后总信息比特数）

3.**密钥相关参数**

- 原始生成矩阵 \(G_0\)：维度 \(11L \times 15L\)（分块对角形式，私钥组件）
- 随机可逆矩阵 S：维度 \(11L \times 11L\)（混淆信息空间，私钥组件）
- 置换矩阵 P：长度 15L（隐藏码结构，私钥组件）
- 公钥生成矩阵 \(G_{\text{pub}}\)：\(G_{\text{pub}} = S \cdot G_0 \cdot P\)，维度 \(11L \times 15L\)

4.**错误模型与通信效率参数**

- 单块最大错误数：1（与纠错能力 t 匹配）
- 错误向量长度：15L（与整体码长一致）

### 12.2.2 基于(15,7)BCH码的McEliece方案参数

1.**基础码参数**

- 单块码长 \(n_0\)：15（单个 BCH 码的码字长度）
- 单块信息位 \(k_0\)：7（单个 BCH 码的信息比特数）
- 最小汉明距离 \(d_{\text{min}}\)：5
- 纠错能力 t：2（由 t= ⌊(\(d_{\text{min}}\)−1)/2⌋ 推导）

2.**分块级联参数**

- 分块数 L：5, 10, 15, 20（与 Hamming 方案保持一致，保证实验可比性）
- 整体码长 n：\(n = 15L\)
- 整体信息位 k：\(k = 7L\)

3.**密钥相关参数**

- 原始生成矩阵 \(G_0\)：维度 \(7L \times 15L\)（分块对角形式）
- 随机可逆矩阵 S：维度 \(7L \times 7L\)
- 置换矩阵 P：长度 15L（块内置换，不跨分块）
- 公钥生成矩阵 \(G_{\text{pub}}\)：\(G_{\text{pub}} = S \cdot G_0 \cdot P\)，维度 \(7L \times 15L\)

4.**错误模型与通信效率参数**

- 单块最大错误数：2（与纠错能力 t 匹配）
- 错误向量长度：15L

---

